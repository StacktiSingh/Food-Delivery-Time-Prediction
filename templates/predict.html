<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Predict Delivery Time</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="min-h-screen bg-gradient-to-br from-black via-slate-900 to-black text-white">

  <div class="max-w-7xl mx-auto px-6 py-14 grid grid-cols-1 lg:grid-cols-2 gap-10">

    <!-- ================= FORM ================= -->

    <form action="/predict" method="post"
      class="bg-white/5 backdrop-blur-xl border border-white/10 rounded-3xl p-10 shadow-2xl">

      <h2 class="text-3xl font-bold mb-10 text-sky-400 text-center">
        Enter Delivery Conditions
      </h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

        <div>
          <label class="text-gray-300 mb-1 block">Rider Age</label>
          <input type="number" name="age" required class="dark-input">
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Rider Rating</label>
          <input type="number" step="0.1" name="rating" required class="dark-input">
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Vehicle Condition</label>
          <select name="vehicle_condition" required class="dark-input">
  <option value="0">0 - Very Poor</option>
  <option value="1">1 - Good</option>
  <option value="2">2 - Very Good</option>
</select>
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Multiple Deliveries</label>
          <select name="multiple_deliveries" required class="dark-input">
  <option value="0">0</option>
  <option value="1">1</option>
  <option value="2">2</option>
  <option value="3">3</option>
</select>
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Pickup Delay (min)</label>
          <input type="number" step="0.1" name="pickup_delay" required class="dark-input">
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Distance (km)</label>
          <input type="number" step="0.1" name="distance" required class="dark-input">
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Order Hour (0–23)</label>
          <input type="number" name="order_hour" required class="dark-input">
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Picked Hour (0–23)</label>
          <input type="number" name="picked_hour" required class="dark-input">
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Peak Hour (1/0)</label>
          <input type="number" name="is_peak" required class="dark-input">
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Order Day</label>
          <input type="text" name="order_day" required class="dark-input">
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Order Month</label>
          <input type="text" name="order_month" required class="dark-input">
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Weekday (0–6)</label>
          <input type="number" name="weekday" required class="dark-input">
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Weekend (1/0)</label>
          <input type="number" name="is_weekend" required class="dark-input">
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Weather</label>
          <select name="weather" required class="dark-input">
  <option value="Sunny">Sunny</option>
  <option value="Cloudy">Cloudy</option>
  <option value="Windy">Windy</option>
  <option value="Fog">Fog</option>
  <option value="Sandstorms">Sandstorms</option>
  <option value="Stormy">Stormy</option>
</select>
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Traffic Density</label>
          <select name="traffic" required class="dark-input">
  <option value="Low">Low</option>
  <option value="Medium">Medium</option>
  <option value="High">High</option>
  <option value="Jam">Jam</option>
</select>
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Type of Order</label>
          <select name="order_type" required class="dark-input">
  <option value="Snack">Snack</option>
  <option value="Meal">Meal</option>
  <option value="Drinks">Drinks</option>
  <option value="Buffet">Buffet</option>
</select>
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Vehicle Type</label>
          <select name="vehicle_type" required class="dark-input">
  <option value="motorcycle">motorcycle</option>
  <option value="Scooter">Scooter</option>
  <option value="Electric Scooter">Electric Scooter</option>
</select>
        </div>

        <div>
          <label class="text-gray-300 mb-1 block">Festival (Yes/No)</label>
          <input type="text" name="festival" required class="dark-input">
        </div>

        <div class="md:col-span-2">
          <label class="text-gray-300 mb-1 block">City</label>
          <select name="city" required class="dark-input">
  <option value="Metropolitian">Metropolitian</option>
  <option value="Urban">Urban</option>
  <option value="Semi-Urban">Semi-Urban</option>
            <option value="Unknown">None of the above</option>
</select>
        </div>

      </div>

      <button
        type="submit"
        class="mt-12 w-full py-4 rounded-full text-lg font-bold text-slate-900
               bg-gradient-to-r from-sky-400 to-cyan-300
               hover:scale-105 transition-transform shadow-lg shadow-sky-400/40">
        Predict Delivery Time
      </button>

    </form>

    <!-- ================= METER ================= -->

    <div class="bg-white/5 backdrop-blur-xl border border-white/10 rounded-3xl p-10 shadow-2xl text-center">

      <h2 class="text-3xl font-bold mb-8 text-sky-400">Estimated Delivery Time</h2>

      <div class="relative w-72 h-36 mx-auto overflow-hidden">
        <div class="absolute inset-0 rounded-t-full bg-[conic-gradient(#22c55e_0deg,#eab308_120deg,#ef4444_240deg,#020617_240deg)]"></div>

        <div id="needle"
             class="absolute bottom-0 left-1/2 w-[6px] h-28 bg-white rounded origin-bottom
                    transition-transform duration-1000"
             style="transform: rotate(-90deg);">
        </div>

        <div class="absolute bottom-1 left-1/2 w-4 h-4 bg-white rounded-full -translate-x-1/2"></div>
      </div>

      <div class="mt-10 text-4xl font-extrabold text-sky-400">
        {{ prediction_text }}
      </div>

      <p class="mt-2 text-gray-400">Fast • Moderate • Slow</p>

    </div>

  </div>


  <!-- ✅ PREDICTION POPUP MODAL -->
<div id="popupOverlay"
     class="fixed inset-0 bg-black/70 backdrop-blur-sm hidden items-center justify-center z-50">

  <div id="popupBox"
       class="bg-slate-900 border border-slate-700 rounded-3xl p-12 shadow-2xl
              text-center w-[350px] transform scale-90 transition-all duration-500">

    <h2 class="text-2xl font-bold text-sky-400 mb-6">Calculating Delivery Time</h2>

    <!-- Meter -->
    <div class="relative w-60 h-32 mx-auto overflow-hidden mb-6">
      <div class="absolute inset-0 rounded-t-full
        bg-[conic-gradient(#22c55e_0deg,#eab308_120deg,#ef4444_240deg,#020617_240deg)]">
      </div>

      <div id="popupNeedle"
           class="absolute bottom-0 left-1/2 w-[6px] h-24 bg-white rounded origin-bottom
                  transition-transform duration-1000"
           style="transform: rotate(-90deg);">
      </div>

      <div class="absolute bottom-1 left-1/2 w-4 h-4 bg-white rounded-full -translate-x-1/2"></div>
    </div>

    <div id="popupTime"
         class="text-3xl font-extrabold text-sky-400 mb-2">
      -- minutes
    </div>

    <button onclick="closePopup()"
      class="mt-4 px-8 py-2 rounded-full bg-gradient-to-r
             from-sky-400 to-cyan-300 text-slate-900 font-bold">
      OK
    </button>

  </div>
</div>


  <!-- ✅ PURE CSS FOR INPUTS (WORKS WITH CDN) -->
  <style>
    .dark-input {
      width: 100%;
      padding: 12px 16px;
      border-radius: 12px;
      background-color: #1e293b;
      border: 1px solid #334155;
      color: #e5e7eb;
      font-size: 1rem;
      outline: none;
      transition: 0.2s;
    }

    .dark-input:focus {
      border-color: #38bdf8;
      box-shadow: 0 0 0 2px rgba(56, 189, 248, 0.4);
      background-color: #0f172a;
    }
  </style>

<script>
  const popup = document.getElementById("popupOverlay");
  const popupNeedle = document.getElementById("popupNeedle");
  const popupTime = document.getElementById("popupTime");
  const popupBox = document.getElementById("popupBox");

  function openPopup(time) {
    popup.classList.remove("hidden");
    popup.classList.add("flex");

    setTimeout(() => {
      popupBox.classList.remove("scale-90");
      popupBox.classList.add("scale-100");
    }, 100);

    let angle = -90 + (time * 3);
    if (angle > 90) angle = 90;

    setTimeout(() => {
      popupNeedle.style.transform = `rotate(${angle}deg)`;
      popupTime.innerText = time + " minutes";
    }, 800);
  }

  function closePopup() {
    popupBox.classList.remove("scale-100");
    popupBox.classList.add("scale-90");

    setTimeout(() => {
      popup.classList.add("hidden");
      popup.classList.remove("flex");
    }, 300);
  }

  {% if delivery_time %}
    setTimeout(() => {
      openPopup({{ delivery_time }});
    }, 400);
  {% endif %}
</script>



</body>
</html>

